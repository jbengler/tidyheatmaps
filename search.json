[{"path":"https://jbengler.github.io/tidyheatmaps/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Jan Broder Engler Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"data-requirements","dir":"Articles","previous_headings":"","what":"Data requirements","title":"Get started","text":"tidy_heatmap() requires tidy data long format, see tidyverse. example use gene expression data set data_exprs. tidyverse lingo columns data frame called variables. variable expression contains numeric values color-coded heatmap. Furthermore use variables sample heatmap columns external_gene_name heatmap rows.","code":"glimpse(data_exprs) #> Rows: 800 #> Columns: 9 #> $ ensembl_gene_id    <chr> \"ENSMUSG00000033576\", \"ENSMUSG00000033576\", \"ENSMUS… #> $ external_gene_name <chr> \"Apol6\", \"Apol6\", \"Apol6\", \"Apol6\", \"Apol6\", \"Apol6… #> $ sample             <chr> \"Hin_1\", \"Hin_2\", \"Hin_3\", \"Hin_4\", \"Hin_5\", \"Ein_1… #> $ expression         <dbl> 2.203755, 2.203755, 2.660558, 2.649534, 3.442740, 5… #> $ group              <chr> \"Hin\", \"Hin\", \"Hin\", \"Hin\", \"Hin\", \"Ein\", \"Ein\", \"E… #> $ sample_type        <chr> \"input\", \"input\", \"input\", \"input\", \"input\", \"input… #> $ condition          <chr> \"healthy\", \"healthy\", \"healthy\", \"healthy\", \"health… #> $ is_immune_gene     <chr> \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no… #> $ direction          <chr> \"up\", \"up\", \"up\", \"up\", \"up\", \"up\", \"up\", \"up\", \"up…"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic usage","title":"Get started","text":"basic layout heatmap relies parameters rows, columns values. can think like aesthetics ggplot2::ggplot(), similar something like aes(x = columns, y = rows, fill = values).","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"data-scaling","dir":"Articles","previous_headings":"","what":"Data scaling","title":"Get started","text":"parameter scale can activate data scaling \"row\" \"column\". default data scaling turned scale = \"none\".","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\" )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"ordering","dir":"Articles","previous_headings":"","what":"Ordering","title":"Get started","text":"Rows columns heatmap appear order tidy data frame used input. example, order rows columns alphabetically, just use dplyr::arrange().","code":"data_exprs %>%    arrange(external_gene_name, sample) %>%    tidy_heatmap(rows = external_gene_name,                columns = sample,                values = expression,                scale = \"row\"   )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"color-legend","dir":"Articles","previous_headings":"","what":"Color legend","title":"Get started","text":"can customize number colors color_legend_n color legend. default 15.  can also define minimum maximum values color legend. Values smaller color_legend_min lowest color, values bigger color_legend_max get highest color.  course, can also change colors . number colors provide match color_legend_n. color legend automatically adjusted color_legend_n colors (default 15).","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              color_legend_n = 5 ) tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              color_legend_min = -1,              color_legend_max = 1 ) tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              colors = c(\"#145afc\",\"#ffffff\",\"#ee4445\") )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"annotations","dir":"Articles","previous_headings":"","what":"Annotations","title":"Get started","text":"Annotations can added rows columns via annotation_row annotation_col, respectively. Just specify corresponding variables tidy data frame. want one variable annotation just combine c(var1, var2, var3).","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction) )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"customize-annotations-colors","dir":"Articles","previous_headings":"Annotations","what":"Customize annotations colors","title":"Get started","text":"can provide list named vectors take control annotations colors annotation_colors.","code":"ann_colors <- list(   condition = c(EAE = \"#BD79B4\", healthy = \"#F5CEF2\"),   group = c(Ein = \"#C14236\", Eip = \"#E28946\", Hin = \"#4978AB\", Hip = \"#98BB85\"),   sample_type = c(input = \"#BDBDBD\", IP = \"#7D7D7D\"),   direction = c(down = \"#5071DC\", up = \"#C34B6B\"),   is_immune_gene = c(yes = \"#B69340\", no = \"#FFFFFF\") )  tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction),              annotation_colors = ann_colors )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"gaps","dir":"Articles","previous_headings":"","what":"Gaps","title":"Get started","text":"Gaps can added specifying data frame variables used generate gaps. one variable can chosen gaps_row gaps_col.","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction),              annotation_colors = ann_colors,              gaps_row = direction,              gaps_col = group )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"cell-dimensions","dir":"Articles","previous_headings":"","what":"Cell dimensions","title":"Get started","text":"can provide absolute cell dimensions (points) via cellwidth cellheight parameters.","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction),              annotation_colors = ann_colors,              gaps_row = direction,              gaps_col = group,              cellwidth = 7,              cellheight = 7 )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"show-selected-labels","dir":"Articles","previous_headings":"","what":"Show selected labels","title":"Get started","text":"highlight selection row column labels hiding rest, can use show_selected_row_labels show_selected_col_labels, respectively.","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction),              annotation_colors = ann_colors,              gaps_row = direction,              gaps_col = group,              cellwidth = 7,              cellheight = 7,              show_selected_row_labels = c(\"Apol6\",\"Bsn\",\"Vgf\",\"Fam96b\",\"Bag1\",\"Aip\"), )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"write-to-file","dir":"Articles","previous_headings":"","what":"Write to file","title":"Get started","text":"can use parameter filename write heatmap file.","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              filename = \"my_heatmap.pdf\" )"},{"path":"https://jbengler.github.io/tidyheatmaps/articles/tidyheatmap.html","id":"more-features","dir":"Articles","previous_headings":"","what":"More features","title":"Get started","text":"pheatmap provides even features like clustering, dendrograms, text within cells, et cetera. Additional available parameters can found documentation tidy_heatmap().","code":"tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              cluster_rows = TRUE,              cluster_cols = TRUE,              display_numbers = TRUE )"},{"path":"https://jbengler.github.io/tidyheatmaps/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jan Broder Engler. Author, maintainer.","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Engler J (2024). tidyheatmaps: Heatmaps Tidy Data. R package version 0.1.0, https://jbengler.github.io/tidyheatmaps/, https://github.com/jbengler/tidyheatmaps.","code":"@Manual{,   title = {tidyheatmaps: Heatmaps From Tidy Data},   author = {Jan Broder Engler},   year = {2024},   note = {R package version 0.1.0, https://jbengler.github.io/tidyheatmaps/},   url = {https://github.com/jbengler/tidyheatmaps}, }"},{"path":"https://jbengler.github.io/tidyheatmaps/index.html","id":"tidyheatmaps-","dir":"","previous_headings":"","what":"Heatmaps From Tidy Data","title":"Heatmaps From Tidy Data","text":"tidyheatmaps simplifies generation publication-ready heatmaps tidy data. offering interface powerful pheatmap package, allows effortless creation intricate heatmaps minimal code.","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Heatmaps From Tidy Data","text":"","code":"# install.packages(\"pak\") pak::pak(\"jbengler/tidyheatmaps\")"},{"path":"https://jbengler.github.io/tidyheatmaps/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Heatmaps From Tidy Data","text":"Given tidy data frame gene expression data like data_exprs, can easily generate customized heatmap.","code":"library(tidyheatmaps)  tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction),              gaps_row = direction,              gaps_col = group )"},{"path":"https://jbengler.github.io/tidyheatmaps/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Heatmaps From Tidy Data","text":"https://jbengler.github.io/tidyheatmaps/","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/data_exprs.html","id":null,"dir":"Reference","previous_headings":"","what":"Expression data from RNA-Seq study — data_exprs","title":"Expression data from RNA-Seq study — data_exprs","text":"data taken form RNA-Seq study investigating regulation genes response central nervous system inflammation.","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/data_exprs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expression data from RNA-Seq study — data_exprs","text":"","code":"data_exprs"},{"path":"https://jbengler.github.io/tidyheatmaps/reference/data_exprs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Expression data from RNA-Seq study — data_exprs","text":"data frame 800 rows 9 variables: ensembl_gene_id Ensembl gene id external_gene_name Gene symbol sample Sample name expression Normalized RNA-Seq expression value group Experimental group sample_type Sample type. Either input IP. condition Condition sampling. Either healthy EAE. is_immune_gene Gene annotated immune cell gene. Either yes . direction Direction regulation. Either .","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/data_exprs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Expression data from RNA-Seq study — data_exprs","text":"data_exprs represents just small subset data aquired study. details study can found Nature Neuroscience, Bassoon proteinopathy drives neurodegeneration multiple sclerosis complete raw data can downloaded Gene Expression Omnibus, study accession GSE104899","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/tidy_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create heatmap from tidy data — tidy_heatmap","title":"Create heatmap from tidy data — tidy_heatmap","text":"tidyverse-style interface powerful heatmap package pheatmap \\@raivokolde. enables convenient generation complex heatmaps tidy data.","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/tidy_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create heatmap from tidy data — tidy_heatmap","text":"","code":"tidy_heatmap(   df,   rows,   columns,   values,   colors = NA,   color_legend_n = 15,   color_legend_min = NA,   color_legend_max = NA,   color_na = \"#DDDDDD\",   annotation_row = NULL,   annotation_col = NULL,   gaps_row = NULL,   gaps_col = NULL,   show_selected_row_labels = NULL,   show_selected_col_labels = NULL,   filename = NA,   scale = \"none\",   fontsize = 7,   cellwidth = NA,   cellheight = NA,   cluster_rows = FALSE,   cluster_cols = FALSE,   border_color = NA,   kmeans_k = NA,   clustering_distance_rows = \"euclidean\",   clustering_distance_cols = \"euclidean\",   clustering_method = \"complete\",   clustering_callback = function(x, ...) {      return(x)  },   cutree_rows = NA,   cutree_cols = NA,   treeheight_row = ifelse((class(cluster_rows) == \"hclust\") || cluster_rows, 50, 0),   treeheight_col = ifelse((class(cluster_cols) == \"hclust\") || cluster_cols, 50, 0),   legend = TRUE,   legend_breaks = NA,   legend_labels = NA,   annotation_colors = NA,   annotation_legend = TRUE,   annotation_names_row = TRUE,   annotation_names_col = TRUE,   drop_levels = TRUE,   show_rownames = TRUE,   show_colnames = TRUE,   main = NA,   fontsize_row = fontsize,   fontsize_col = fontsize,   angle_col = c(\"270\", \"0\", \"45\", \"90\", \"315\"),   display_numbers = FALSE,   number_format = \"%.2f\",   number_color = \"grey30\",   fontsize_number = 0.8 * fontsize,   width = NA,   height = NA,   silent = FALSE )"},{"path":"https://jbengler.github.io/tidyheatmaps/reference/tidy_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create heatmap from tidy data — tidy_heatmap","text":"df tidy dataframe long format. rows, columns Column dataframe use heatmap rows columns. values Column dataframe containing values color coded heatmap cells. colors Vector colors used color legend. color_legend_n Number colors color legend. color_legend_min, color_legend_max Min max value color legend. Values smaller color_legend_min lowest color, values bigger color_legend_max get highest color. color_na Color use NAs values. annotation_row, annotation_col Column(s) dataframe use row column annotation. use multiple columns annotation combine c(column1, column2). gaps_row, gaps_col Column dataframe use use row column gaps. show_selected_row_labels, show_selected_col_labels display subset selected labels rows columns. Provide selected labels c(\"label1\", \"label2\"). filename file path save picture. Filetype decided  extension path. Currently following formats supported: png, pdf, tiff,  bmp, jpeg. Even plot fit plotting window, file size  calculated plot fit , unless specified otherwise. scale character indicating values centered scaled  either row direction column direction, none. Corresponding values  \"row\", \"column\" \"none\" fontsize base fontsize plot cellwidth individual cell width points. left NA, values  depend size plotting window. cellheight individual cell height points. left NA,  values depend size plotting window. cluster_rows boolean values determining rows clustered hclust object, cluster_cols boolean values determining columns clustered hclust object. border_color color cell borders heatmap, use NA border  drawn. kmeans_k number kmeans clusters make, want aggregate  rows drawing heatmap. NA rows aggregated. clustering_distance_rows distance measure used clustering rows. Possible  values \"correlation\" Pearson correlation distances  supported dist, \"euclidean\", etc. value none  assumed distance matrix provided. clustering_distance_cols distance measure used clustering columns. Possible  values clustering_distance_rows. clustering_method clustering method used. Accepts values  hclust. clustering_callback callback function modify clustering.  called two parameters: original hclust object matrix  used clustering. Must return hclust object. cutree_rows number clusters rows divided , based  hierarchical clustering (using cutree), rows clustered,  argument ignored cutree_cols similar cutree_rows, columns treeheight_row height tree rows, clustered.  Default value 50 points. treeheight_col height tree columns, clustered.  Default value 50 points. legend logical determine legend drawn . legend_breaks vector breakpoints legend. legend_labels vector labels legend_breaks. annotation_colors list specifying annotation_row  annotation_col track colors manually.  possible define colors  features. Check examples  details. annotation_legend boolean value showing legend annotation  tracks drawn. annotation_names_row boolean value showing names row annotation  tracks drawn. annotation_names_col boolean value showing names column annotation  tracks drawn. drop_levels logical determine unused levels also shown  legend show_rownames boolean specifying column names shown. show_colnames boolean specifying column names shown. main title plot fontsize_row fontsize rownames (Default: fontsize) fontsize_col fontsize colnames (Default: fontsize) angle_col angle column labels, right now one can choose  predefined options (0, 45, 90, 270 315) display_numbers logical determining numeric values also printed  cells. matrix (dimensions original matrix), contents matrix shown instead original values. number_format format strings (C printf style) numbers shown cells.  example \"%.2f\" shows 2 decimal places \"%.1e\" shows exponential  notation (see sprintf). number_color color text fontsize_number fontsize numbers displayed cells width manual option determining output file width inches. height manual option determining output file height inches. silent draw plot (useful using gtable output)","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/tidy_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create heatmap from tidy data — tidy_heatmap","text":"Invisibly pheatmap object list components tree_row clustering rows hclust object tree_col clustering columns hclust object kmeans kmeans clustering rows parameter kmeans_k specified gtable gtable object containing heatmap, can used combining heatmap plots","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/tidy_heatmap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create heatmap from tidy data — tidy_heatmap","text":"tidy_heatmap() requires tidy data long format, see tidyverse. documentation also look Get started guide.","code":""},{"path":"https://jbengler.github.io/tidyheatmaps/reference/tidy_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create heatmap from tidy data — tidy_heatmap","text":"","code":"# Basic example tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\" )   # Change number of colors in color lengend tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              color_legend_n = 5 )   # Change color in color legend tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              colors = c(\"#145afc\",\"#ffffff\",\"#ee4445\") )   # Add row and column annotation tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction) )   # Add gaps between rows and columns tidy_heatmap(data_exprs,              rows = external_gene_name,              columns = sample,              values = expression,              scale = \"row\",              annotation_col = c(sample_type, condition, group),              annotation_row = c(is_immune_gene, direction),              gaps_row = direction,              gaps_col = group )"},{"path":"https://jbengler.github.io/tidyheatmaps/news/index.html","id":"tidyheatmaps-010","dir":"Changelog","previous_headings":"","what":"tidyheatmaps 0.1.0","title":"tidyheatmaps 0.1.0","text":"Intial submission. goal ‘tidyheatmaps’ provide tidyverse-style interface powerful heatmap package ‘pheatmap’ @raivokolde. enables convenient generation complex heatmaps tidy data minimal code.","code":""}]
